# Bluetooth audio configuration for WirePlumber
# - High-quality codecs (LDAC, aptX HD preferred)
# - BT devices get higher priority than USB/built-in
# - A2DP profile for audio (not headset/HFP)
# - Stream auto-switch handled by systemd service

monitor.bluez.properties = {
  bluez5.roles = [ a2dp_sink a2dp_source bap_sink bap_source hsp_hs hsp_ag hfp_hf hfp_ag ]
  bluez5.codecs = [ ldac aptx_hd aptx aac sbc_xq sbc ]
  bluez5.enable-sbc-xq = true
  bluez5.enable-msbc = true
  bluez5.enable-hw-volume = true
  bluez5.autoswitch-profile = true
  bluez5.auto-connect = true
  bluez5.default-rate = 48000
  bluez5.default-channels = 2
}

monitor.bluez.rules = [
  {
    matches = [
      {
        node.name = "~bluez_output.*"
      }
    ]
    actions = {
      update-props = {
        priority.driver = 2000
        priority.session = 2000
        node.pause-on-idle = false
        session.suspend-timeout-seconds = 0
      }
    }
  }
  {
    matches = [
      {
        device.name = "~bluez_card.*"
      }
    ]
    actions = {
      update-props = {
        bluez5.auto-connect = [ a2dp_sink ]
        device.profile = "a2dp-sink"
      }
    }
  }
]
