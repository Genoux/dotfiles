# Auto-switch to Bluetooth audio devices
# - BT devices get higher priority than USB/built-in
# - Most recently connected BT device becomes default
# - Force A2DP profile for high-quality audio (not HFP/headset)

monitor.bluez.rules = [
  {
    matches = [
      {
        # All Bluetooth audio sink nodes
        node.name = "~bluez_output.*"
        media.class = "Audio/Sink"
      }
    ]
    actions = {
      update-props = {
        # Higher priority than USB (default ~1100) and built-in (default ~1000)
        priority.driver = 2000
        priority.session = 2000
        node.pause-on-idle = false
      }
    }
  }
]

# Policy to auto-switch default sink to newly connected Bluetooth devices
policy.node.rules = [
  {
    matches = [
      {
        node.name = "~bluez_output.*"
        node.features = "!monitor"
      }
    ]
    actions = {
      # Set as default when Bluetooth device becomes available
      set-default = true
    }
  }
]

# Ensure A2DP profile is selected for Bluetooth devices (not HFP/headset)
policy.device.rules = [
  {
    matches = [
      {
        device.name = "~bluez_card.*"
      }
    ]
    actions = {
      update-props = {
        device.profile.name = "a2dp-sink"
      }
    }
  }
]
