#!/bin/sh
# Display system info - TUI style, no shell prompt
# Single instance support - focuses existing window if already running

TERMINAL_TITLE="SystemInfo"

# If we're already in display mode (env var set), just run the display
if [ "$SYSTEM_INFO_DISPLAY" = "1" ]; then
    # Clear screen and hide cursor
    tput clear
    tput civis
    
    # Run fastfetch
    fastfetch
    
    # Wait for any keypress (silent, no echo)
    stty -echo
    read -n 1 -s
    stty echo
    
    # Show cursor and exit cleanly
    tput cnorm
    exit 0
fi

# Check if SystemInfo window is already running
if hyprctl clients 2>/dev/null | grep -q "^[[:space:]]*title: $TERMINAL_TITLE$"; then
    # Focus the existing window
    hyprctl dispatch focuswindow title:"$TERMINAL_TITLE" 2>/dev/null
else
    # Launch new instance with specific size
    kitty --class=help-about --title "$TERMINAL_TITLE" \
        -o initial_window_width=80c \
        -o initial_window_height=24c \
        env SYSTEM_INFO_DISPLAY=1 "$0" 2>/dev/null &
fi

