#!/bin/bash

# Auto-close special workspace when switching to regular workspaces
# Usage: system-workspace-switch <workspace_number>

[ $# -eq 0 ] && { echo "Usage: $0 <workspace_number>"; exit 1; }

WORKSPACE=$1

# Close special workspace if currently visible on monitor
SPECIAL_VISIBLE=$(hyprctl monitors -j | jq -r '.[].specialWorkspace.name' | grep -v '^$')

if [ -n "$SPECIAL_VISIBLE" ]; then
    SPECIAL_NAME=${SPECIAL_VISIBLE#special:}
    [ "$SPECIAL_NAME" = "special" ] && hyprctl dispatch togglespecialworkspace || hyprctl dispatch togglespecialworkspace "$SPECIAL_NAME"
fi

# Switch to target workspace
hyprctl dispatch workspace "$WORKSPACE"